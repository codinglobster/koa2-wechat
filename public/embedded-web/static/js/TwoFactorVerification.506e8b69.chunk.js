(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{637:function(e,t,n){},639:function(e,t,n){e.exports={twoFactorVerification:"TwoFactorVerification_twoFactorVerification__Ona1d",mainContent:"TwoFactorVerification_mainContent__1Coma",title:"TwoFactorVerification_title__2EJ6c",sendTip:"TwoFactorVerification_sendTip__2FKud",sendTo:"TwoFactorVerification_sendTo__154Qx",inputWrapper:"TwoFactorVerification_inputWrapper__1COjM",linkWrapper:"TwoFactorVerification_linkWrapper__1Dbf0",confirmBtn:"TwoFactorVerification_confirmBtn__1nD0H"}},720:function(e,t,n){"use strict";n.r(t);var a=n(14),o=n(15),r=n(21),i=n(20),c=n(22),s=n(0),p=n.n(s),u=n(57),l=n(56),f=n(717),d=n(88),h=n(571),v=n(113),w=n(573),b=n(112),m=n(145),F=n(576),T=(n(273),n(637)),C=n.n(T),j=m.d.DEFAULT,O=m.d.ERROR,k=m.c.VERCODE,g=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={twoFactorCode:"",tipLevel:j,verifyTip:""},n.onFocus=n.onFocus.bind(Object(v.a)(n)),n.onChange=n.onChange.bind(Object(v.a)(n)),n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.verifyTip,n=e.tipLevel,a=e.inputType,o=e.twoFactorCode,r=e.resetInput;a===k&&this.setState({verifyTip:t,tipLevel:n}),r&&this.setState({twoFactorCode:o})}},{key:"onFocus",value:function(){this.setState({tipLevel:j,verifyTip:""})}},{key:"onChange",value:function(e){var t=e.target.value,n=this.props.onChange;this.setState({twoFactorCode:t}),n(e)}},{key:"verifyInput",value:function(){var e,t=this,n=this.state.twoFactorCode,a="",o="";return n?F.c.test(n)?(o=j,e=Promise.resolve(n)):(a=b.T,o=O,e=Promise.reject(new Error(a))):(a=b.J,o=O,e=Promise.reject(new Error(a))),e.finally(function(){t.setState({verifyTip:a,tipLevel:o})})}},{key:"render",value:function(){var e=this.state,t=e.tipLevel,n=e.verifyTip,a=e.twoFactorCode,o=this.props,r=o.customTip,i=o.placeHolder;return p.a.createElement("div",{className:C.a.twoFactorCodeInput},p.a.createElement(w.a,{placeHolder:i||b.P,tipLevel:t,value:a,onFocus:this.onFocus,onChange:this.onChange,useDefaultTip:!r},n))}}]),t}(s.Component);g.defaultProps={twoFactorCode:"",resetInput:!1,onChange:function(){}};var y=g,_=n(570),E=(n(572),n(569)),I=n(639),S=n.n(I),L=m.d.DEFAULT,V=m.d.ERROR,W=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(i.a)(t).call(this,e))).onInputChange=function(e){var t=e.target.value;n.setState({twoFactorCode:t})},n.onInputFocus=function(){n.setState({tipLevel:L,verifyTip:""})},n.login=function(){var e,t,a,o,r=n.state,i=r.twoFactorCode,c=r.targetUrl,s=n.props,p=s.twoFactorInfo,u=p.twoFactorToken,d=p.fromWechatLogin,h=s.wechatSessionId;i?(n.setState({requesting:!0}),e=Object(l.post)(E.b,{code:i,twoFactorToken:u},{needSignature:!0}).then(function(e){var t=Object(f.a)(e,"data.code"),n=Object(f.a)(e,"data.content.authToken");o=Object(f.a)(e,"data.content");var a=!1;switch(t){case 200:a=!!n;break;default:a=!1}return a?n:Promise.reject()}),c?e.then(function(e){e&&(window.location.href=c)}).catch(function(e){console.log(e)}):e.then(function(e){return Object(l.post)(E.a,{authToken:e,sessionId:h},{needSignature:!0})}).then(function(e){var t;switch(Object(f.a)(e,"data.code")){case 200:t=!!o;break;case 404:t=!1,Object(_.a)({content:b.U});break;case 423:Object(_.a)({content:b.a});break;case 425:d?t=!!o:(t=!1,Object(_.a)({content:b.Jb}));break;default:t=!1,Object(_.a)({content:b.r})}return t?o:Promise.reject()}).then(function(e){e.authToken,e.hpts,e.hsHash}).catch(function(e){console.log(e)}).finally(function(){n.setState({requesting:!1})})):(t=V,a=b.J,n.setState({tipLevel:t,verifyTip:a}))},n.redirectToHelper=function(){n.props.history.push("/twofactor-helper")},n.state={twoFactorCode:"",rememberMe:!1,tipLevel:L,verifyTip:"",requesting:!1},n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.twoFactorInfo.twoFactorEnabled,n=e.history,a=window.location.search,o=Object(d.parse)(a).targetUrl;o=o&&decodeURIComponent(o),t||n.replace("/"),this.setState({targetUrl:o})}},{key:"componentDidMount",value:function(){document.title="\u4e24\u6b65\u9a8c\u8bc1"}},{key:"cancel",value:function(){window.history.back()}},{key:"render",value:function(){var e=this.state,t=e.requesting,n=e.tipLevel,a=e.verifyTip,o=this.props.twoFactorInfo.twoFactorHint;return p.a.createElement("div",{className:S.a.twoFactorVerification},p.a.createElement("div",{className:S.a.mainContent},p.a.createElement("h1",{className:S.a.title},b.wb),p.a.createElement("p",{className:S.a.sendTip},!o&&p.a.createElement("span",{className:S.a.sendTo},"XX XXX XXXX 3251")),p.a.createElement("div",{className:S.a.inputWrapper},p.a.createElement(y,{placeHolder:b.tb,tipLevel:n,verifyTip:a,onChange:this.onInputChange,onFocus:this.onInputFocus})),p.a.createElement(h.a,{text:b.t,loading:t,buttonWrapperClass:S.a.confirmBtn,onClick:this.login}),p.a.createElement("div",{className:S.a.linkWrapper},p.a.createElement(h.a,{text:b.V,buttonWrapperClass:S.a.linkWrapper,onClick:this.redirectToHelper}))))}}]),t}(s.Component);t.default=Object(u.b)(function(e){return{wechatSessionId:e.wechatSessionId,twoFactorInfo:e.twoFactorInfo}},{})(W)}}]);
//# sourceMappingURL=TwoFactorVerification.506e8b69.chunk.js.map