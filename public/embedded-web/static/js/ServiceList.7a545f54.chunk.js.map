{"version":3,"sources":["account/routeComponents/ServiceList/index.module.scss","account/routeComponents/ServiceList/index.jsx"],"names":["module","exports","serviceList","title","block","top","avator","alias","line","label","value","leftBlock","evernote","myyxbj","microlist","detail","name","detailInfo","rightBlock","connectBtn","direct","desc","confirmBtn","ServiceList","state","devices","deviceKey","type","deviceSession","consumerKey","createTime","lastAccessTime","appName","channelId","deviceIdentifier","deviceDescription","isConnected","confirmCancelConnect","confirm","TIP","content","CANCEL_CONNECT_TIP","operates","text","YES","onClick","_this","cancelConnect","NO","main","_ref","console","log","WechatUnificationService","Disconnect","then","data","catch","e","error","reconnect","Reconnect","getConnectButton","msg","CANCEL_CONNECT","RECONNECT","cb","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","className","styles","_this2","this","wechatSessionId","props","history","push","ListUserDevices","setState","Object","_Users_LiuXiao_workfiled_embedded_web_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","toObject","warn","_this3","AUTHORIZE_SERVICES_TITLE","map","item","_item$deviceSession","iconClass","concat","key","Component","connect","setWechatJsReady"],"mappings":"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","file":"static/js/ServiceList.7a545f54.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"serviceList\":\"ServiceList_serviceList__3yI3_\",\"title\":\"ServiceList_title__1bXN1\",\"block\":\"ServiceList_block__1Z45I\",\"top\":\"ServiceList_top__1skhM\",\"avator\":\"ServiceList_avator__19oI9\",\"alias\":\"ServiceList_alias__1OWdf\",\"line\":\"ServiceList_line__DixiN\",\"label\":\"ServiceList_label__1Z-Gf\",\"value\":\"ServiceList_value__1frm8\",\"leftBlock\":\"ServiceList_leftBlock__1PS2U\",\"evernote\":\"ServiceList_evernote__1PRX3\",\"myyxbj\":\"ServiceList_myyxbj__34z9d\",\"microlist\":\"ServiceList_microlist__1_QQB\",\"detail\":\"ServiceList_detail__3tRKL\",\"name\":\"ServiceList_name__3HL7X\",\"detailInfo\":\"ServiceList_detailInfo__2m0bi\",\"rightBlock\":\"ServiceList_rightBlock__3d7ox\",\"connectBtn\":\"ServiceList_connectBtn__3kNXm\",\"direct\":\"ServiceList_direct__2i3KA\",\"desc\":\"ServiceList_desc__1_r-r\",\"confirmBtn\":\"ServiceList_confirmBtn__3k5eV\"};","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport confirm from '../../components/Confirm/Confirm';\nimport {\n    TIP,\n    CANCEL_CONNECT_TIP,\n    YES,\n    NO,\n    CANCEL_CONNECT,\n    RECONNECT,\n    AUTHORIZE_SERVICES_TITLE,\n} from '../../config/copywriting';\nimport WechatUnificationService from '../../service/WechatUnificationService';\n\nimport styles from './index.module.scss';\n\n\nclass ServiceList extends Component {\n\n    state = {\n        devices: [\n            {\n                deviceKey: '',\n                name: '',\n                type: '印象笔记IOS版',\n                deviceSession: {\n                    consumerKey: '',\n                    createTime: '',\n                    lastAccessTime: '',\n                    appName: '',\n                    channelId: '',\n                    deviceIdentifier: '',\n                    deviceDescription: '',\n                    isConnected: true,\n                }  \n            }\n        ]\n    }\n\n    componentDidMount() {\n        const { wechatSessionId } = this.props;\n        if (!wechatSessionId) this.props.history.push('/account-info');\n        WechatUnificationService.ListUserDevices(wechatSessionId)\n            .then((data) => {\n                this.setState({\n                    ...data.toObject(),\n                })\n            }).catch((e) => {\n                console.warn(e);\n            })\n    }\n\n    confirmCancelConnect = (deviceSession) => {\n        confirm({\n            title: TIP,\n            content: CANCEL_CONNECT_TIP,\n            operates: [{\n              text: YES,\n              onClick: () => this.cancelConnect(deviceSession),\n            },\n            {\n              text: NO,\n              main: true,\n            }]\n          })\n    }\n\n    cancelConnect = ({ channelId }) => {\n        console.log('do something');\n        WechatUnificationService.Disconnect(channelId)\n            .then((data) => {\n\n            }).catch((e) => {\n                console.error(e);\n            })\n    }\n\n    reconnect = (deviceSession) => {\n        const { channelId, deviceIdentifier, deviceDescription } = deviceSession;\n        WechatUnificationService.Reconnect(channelId, deviceIdentifier, deviceDescription)\n            .then((data) => {\n\n            }).catch((e) => {\n                console.error(e);\n            })\n    }\n\n    getConnectButton = (deviceSession) => {\n        const { isConnected } = deviceSession;\n        console.log(isConnected, typeof isConnected)\n        if (typeof isConnected !== 'boolean') return\n        const msg = isConnected ? CANCEL_CONNECT : RECONNECT;\n        const cb = isConnected ? this.confirmCancelConnect : this.reconnect;\n        return (\n            <div className={styles.rightBlock}>\n                <button className={styles.connectBtn}\n                        onClick={() => cb(deviceSession)}\n                >{msg}</button>\n                <div className={styles.direct}></div>\n            </div>\n        )\n    }\n\n    render() {\n        const { devices } = this.state;\n        return (\n            <div className={styles.serviceList}>\n                <div className={styles.title}>\n                    <span>{AUTHORIZE_SERVICES_TITLE}</span>\n                </div>\n                <div className={styles.block}>\n                    {devices.map((item) => {\n                        const { deviceKey, type, deviceSession = {} } = item;\n                        const { deviceDescription, lastAccessTime } = deviceSession;\n                        const iconClass = `${styles.avator} ${styles.evernote}`; // todo base on type change classname\n                        return (\n                            <div className={styles.line} key={deviceKey} >\n                                <div className={styles.leftBlock}>\n                                    <div className={iconClass}></div>\n                                    <div className={styles.detail}>\n                                        <div className={styles.name}>{type}</div>\n                                        <div className={styles.detailInfo}>{deviceDescription}</div>\n                                        <div className={styles.detailInfo}>{lastAccessTime}</div>\n                                    </div>\n                                </div>\n                                {this.getConnectButton(deviceSession)}\n                            </div>\n                        )\n                    })}\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        wechatSessionId: state.wechatSessionId,\n        setWechatJsReady: state.setWechatJsReady,\n    };\n};\n  \nexport default connect(\n    mapStateToProps,\n)(ServiceList);\n"],"sourceRoot":""}