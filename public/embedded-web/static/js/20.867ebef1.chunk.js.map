{"version":3,"sources":["lark/components/Description/index.js","lark/components/Description/index.module.scss","lark/routeComponents/LarkYXAuthorize/index.module.scss","lark/routeComponents/LarkYXAuthorize/index.js"],"names":["react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","_index_module_scss__WEBPACK_IMPORTED_MODULE_1__","_index_module_scss__WEBPACK_IMPORTED_MODULE_1___default","Description","_ref","content","className","a","createElement","Array","isArray","map","item","index","key","styles","describe","ele","resolveArrayItem","module","exports","page","authorizeContainer","authorizeTitle","authorizeContent","contentLeft","contentRight","authorizeButton","refuseButton","authorizeTips","opertionContent","checkDetail","thirdParty","allowOperations","refuseOperations","COPY_CHECK_DETAILED_DESC_LIST","copywritingHelper","CHECK_DETAILED_DESC","react__WEBPACK_IMPORTED_MODULE_6___default","href","THIRD_PARTY_PROVISION","LarkYXAuthorize","state","requesting","validityType","handleAuthorize","_this","_this$props","props","history","setTipStatus","setBindStatus","sessionId","localStorage","getItem","authToken","loginKey","loginSecret","validityPeriod","YX_AUTHORIZE_OPTIONS","find","type","date","setState","post","LARK_BIND_USER_BY_AUTH_TOKEN","needSignature","then","data","code","getValue","SUCCESS_CODE","checkBindStatus","USER_IS_BOUND","tip","BIND_EXIST","isTipShow","setTimeout","goBack","SESSION_INVALID_CODE","INVALID_SESSION","console","log","COMMON_ERROR_TIPS","catch","INTERNET_ERROR_TIPS","finally","handleRefuse","removeItem","push","handleValidityDate","e","target","value","_this$props2","LARK_CHECK_STATUS_BY_AUTH_TOKEN","platform","LARK_PLATFORM","BIND_SUCCESS","this","_components_Header__WEBPACK_IMPORTED_MODULE_13__","mainContent","YX_AUTHORIZE_TEXT","label","onChange","REVOKE_AUTHORIZE","buttonWrapper","_components_BasicButton__WEBPACK_IMPORTED_MODULE_10__","text","AUTHORIZE","buttonWrapperClass","onClick","loading","REFUSE","YX_ALLOW_LABEL","YX_ALLOW_OPERATIONS","YX_REFUSE_LABEL","YX_REFUSE_OPERATIONS","_components_Description__WEBPACK_IMPORTED_MODULE_12__","_components_BasicModal__WEBPACK_IMPORTED_MODULE_11__","Component","connect","Object","_Users_LiuXiao_workfiled_embedded_web_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","actions"],"mappings":"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","file":"static/js/20.867ebef1.chunk.js","sourcesContent":["import React from 'react';\n\nimport styles from './index.module.scss';\n\nconst resolveArrayItem = (item) => {\n  if (Array.isArray(item)) {\n    return item.map((ele,index) => <span key={index}>{ele}</span>);\n  }\n  return item;\n}\n\nconst Description = ({content, className}) => {\n  return <div className={className}>\n            {Array.isArray(content) ?\n              content.map((item,index) => <p key={index} className={styles.describe}>{resolveArrayItem(item)}</p>) :\n              <p className={styles.describe}>{content}</p>\n            }\n         </div>\n}\n\nexport default Description;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"describe\":\"Description_describe__2xkYH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"LarkYXAuthorize_page__2VLXV\",\"authorizeContainer\":\"LarkYXAuthorize_authorizeContainer__1FrVT\",\"authorizeTitle\":\"LarkYXAuthorize_authorizeTitle__Z6ux7\",\"authorizeContent\":\"LarkYXAuthorize_authorizeContent__MRQOZ\",\"contentLeft\":\"LarkYXAuthorize_contentLeft__3SFhf\",\"contentRight\":\"LarkYXAuthorize_contentRight__2OSM9\",\"authorizeButton\":\"LarkYXAuthorize_authorizeButton__3001B\",\"refuseButton\":\"LarkYXAuthorize_refuseButton__2TmoP\",\"authorizeTips\":\"LarkYXAuthorize_authorizeTips__2T_qK\",\"opertionContent\":\"LarkYXAuthorize_opertionContent__WS6BW\",\"checkDetail\":\"LarkYXAuthorize_checkDetail__2asLJ\",\"thirdParty\":\"LarkYXAuthorize_thirdParty__g7DSG\",\"allowOperations\":\"LarkYXAuthorize_allowOperations__mq0NU\",\"refuseOperations\":\"LarkYXAuthorize_refuseOperations__3iwHJ\"};","import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport {post} from 'axios';\nimport {get as getValue} from 'lodash-es';\n\nimport BasicButton from '../../components/BasicButton';\nimport BasicModal from '../../components/BasicModal';\nimport Description from '../../components/Description';\nimport Header from '../../components/Header';\n\nimport {\n  YX_AUTHORIZE_TEXT,\n  YX_ALLOW_LABEL,\n  YX_REFUSE_LABEL,\n  YX_ALLOW_OPERATIONS,\n  YX_REFUSE_OPERATIONS,\n  REVOKE_AUTHORIZE,\n  CHECK_DETAILED_DESC,\n  AUTHORIZE,\n  REFUSE,\n  BIND_SUCCESS,\n  INVALID_SESSION,\n  COMMON_ERROR_TIPS,\n  INTERNET_ERROR_TIPS,\n  BIND_EXIST,\n} from '../../config/copyWriting';\nimport {YX_AUTHORIZE_OPTIONS} from '../../config/propsPermittedValueMap';\nimport {LARK_BIND_USER_BY_AUTH_TOKEN, LARK_CHECK_STATUS_BY_AUTH_TOKEN} from '../../config/interfaceUrl';\nimport {LARK_PLATFORM} from '../../config/interfaceParam';\nimport {THIRD_PARTY_PROVISION} from '../../config/pageUrl';\nimport {SUCCESS_CODE, SESSION_INVALID_CODE, USER_IS_BOUND} from '../../config/interfaceResCode';\nimport copywritingHelper from '../../utils/copywritingHelper';\nimport * as actions from '../../store/actions';\n\nimport styles from './index.module.scss';\n\nconst COPY_CHECK_DETAILED_DESC_LIST = copywritingHelper(CHECK_DETAILED_DESC, (item) => <a className={styles.thirdParty} href={THIRD_PARTY_PROVISION}>{item}</a>);\n\nclass LarkYXAuthorize extends Component {\n  state = {\n    requesting: false,\n    validityType: 0,\n  }\n\n  handleAuthorize = () => {\n    const {validityType} = this.state;\n    const {history, setBindStatus, setTipStatus} = this.props;\n    const sessionId = localStorage.getItem('sessionId');\n    const authToken = localStorage.getItem('authToken');\n    const loginKey = localStorage.getItem('loginKey');\n    const loginSecret = localStorage.getItem('loginSecret');\n    const validityPeriod = YX_AUTHORIZE_OPTIONS.find((item) => item.type === +validityType).date;\n    this.setState({\n      requesting: true,\n    });\n    post(LARK_BIND_USER_BY_AUTH_TOKEN, {\n      authToken,\n      sessionId,\n      loginKey,\n      loginSecret,\n      validityPeriod,\n    }, {\n      needSignature: true,\n    }).then((data) => {\n      const code = getValue(data, 'data.code');\n      switch(code) {\n        case SUCCESS_CODE:\n          this.checkBindStatus(authToken);\n          break;\n        case USER_IS_BOUND:\n          setTipStatus({tip: BIND_EXIST, isTipShow: true});\n          setTimeout(() => {\n            history.goBack();\n          }, 1500);\n          break;\n        case SESSION_INVALID_CODE:\n          setTipStatus({tip: INVALID_SESSION, isTipShow: true});\n          break;\n        default:\n          console.log('error', code);    \n          setTipStatus({tip: COMMON_ERROR_TIPS, isTipShow: true});\n      }\n    }).catch(() => {\n      setTipStatus({tip: INTERNET_ERROR_TIPS, isTipShow: true});\n    }).finally(() => {\n      this.setState({\n        requesting: false,\n      });\n    });\n  }\n\n  handleRefuse = () => {\n    const {history} = this.props;\n    localStorage.removeItem('sessionId');\n    localStorage.removeItem('authToken');\n    history.push('/yx-home');\n  }\n\n  handleValidityDate = (e) => {\n    const validityType = e.target.value;\n    this.setState({\n      validityType,\n    });\n  }\n\n  checkBindStatus = (authToken) => {\n    const {history, setTipStatus, setBindStatus} = this.props;\n    post(LARK_CHECK_STATUS_BY_AUTH_TOKEN, {\n      authToken,\n      platform: LARK_PLATFORM,\n    }, {\n      needSignature: true,\n    }).then(data => {\n      const code = getValue(data, 'data.code');\n      switch (code) {\n        case SUCCESS_CODE:\n          setBindStatus(true);\n          setTipStatus({tip: BIND_SUCCESS, isTipShow: true});\n          setTimeout(() => {\n            history.push('/yx-home');\n          }, 1500);\n          break;\n        case USER_IS_BOUND:\n          setTipStatus({tip: BIND_EXIST, isTipShow: true});\n          setTimeout(() => {\n            history.goBack();\n          }, 1500);\n          break;\n        case SESSION_INVALID_CODE:\n          setTipStatus({tip: INVALID_SESSION, isTipShow: true});\n          break;\n        default:\n          setTipStatus({tip: COMMON_ERROR_TIPS, isTipShow: true});\n      }\n    });\n  }\n\n  render() {\n    const {requesting} = this.state;\n\n    return (\n      <div className={styles.page}>\n        <Header />\n        <div className={styles.mainContent}>\n          <div className={styles.authorizeContainer}>\n            <p className={styles.authorizeTitle}>{YX_AUTHORIZE_TEXT}</p>\n            <div className={styles.authorizeContent}>\n              <div className={styles.contentLeft}>\n                <label className={styles.label}></label>\n                <select onChange={this.handleValidityDate}>\n                  {YX_AUTHORIZE_OPTIONS.map((item, index) => (\n                    <option key={index} value={item.type}>{item.value}</option>\n                  ))}\n                </select>\n                <p>{REVOKE_AUTHORIZE}</p>\n              </div>\n              <div className={styles.contentRight}>\n                <div className={styles.buttonWrapper}>\n                  <BasicButton text={AUTHORIZE}\n                              buttonWrapperClass={styles.authorizeButton}\n                              onClick={this.handleAuthorize}\n                              loading={requesting}\n                  />\n                </div>\n                <div className={styles.buttonWrapper}>\n                  <BasicButton text={REFUSE}\n                              buttonWrapperClass={styles.refuseButton}\n                              onClick={this.handleRefuse}\n                  />\n                </div>\n              </div>\n            </div>\n            <div className={styles.authorizeTips}>\n              <div className={styles.opertionContent}>\n                <div className={styles.allowOperations}>\n                  <h3>{YX_ALLOW_LABEL}</h3>\n                  {YX_ALLOW_OPERATIONS.map((item, index) => (\n                    <p key={index}>{item}</p>\n                  ))}\n                </div>\n                <div className={styles.refuseOperations}>\n                  <h3>{YX_REFUSE_LABEL}</h3>\n                  {YX_REFUSE_OPERATIONS.map((item, index) => (\n                    <p key={index}>{item}</p>\n                  ))}\n                </div>\n              </div>\n              <Description content={COPY_CHECK_DETAILED_DESC_LIST} className={styles.checkDetail} />\n            </div>\n          </div>\n        </div>\n        <BasicModal />\n      </div>\n    )\n  }\n}\n\nexport default connect((state) => ({...state}), actions)(LarkYXAuthorize);\n"],"sourceRoot":""}