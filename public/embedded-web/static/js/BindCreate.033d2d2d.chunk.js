(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{590:function(e,t,n){"use strict";n.d(t,"i",function(){return o}),n.d(t,"l",function(){return r}),n.d(t,"n",function(){return c}),n.d(t,"m",function(){return i}),n.d(t,"k",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"f",function(){return p}),n.d(t,"a",function(){return d}),n.d(t,"h",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"j",function(){return h}),n.d(t,"b",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return m}),window.cly=function(e,t,n){window.Countly.q.push(["add_event",{key:e,segmentation:{eventAction:t,eventLabel:n}}])};var a=function(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=window).cly.apply(e,["WX_ACCOUNT_MYYXBJ"].concat(n))},o=function(){return a("Create_NewAccount_page","ShowPage")},r=function(){return a("Create_NewAccount_page","Enter_PhoneNum")},c=function(){return a("Create_NewAccount_page","Click_Verify_Code")},i=function(){return a("Create_NewAccount_page","Enter_Verify_Code")},s=function(){return a("Create_NewAccount_page","Enter_Password")},u=function(){return a("Create_NewAccount_page","Click_Create_NewAccount")},p=function(){return a("Create_NewAccount_page","Click_No_Verify_Code")},d=function(){return a("Create_NewAccount_page","Click_Bind_ExistedAccount")},l=function(){return a("Bind_ExistedAccount_page","ShowPage")},f=function(){return a("Bind_ExistedAccount_page","Enter_Account")},h=function(){return a("Bind_ExistedAccount_page","Enter_Password")},v=function(){return a("Bind_ExistedAccount_page","Cllick_Continue")},b=function(){return a("Bind_ExistedAccount_page","Click_Forget_Password")},m=function(){return a("Bind_ExistedAccount_page","Click_Create_NewAccount")}},593:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(573),c=n(112),i=n(576),s=n(594),u=n.n(s);t.a=function(e){var t=e.copywriting,n=void 0===t?c.f:t;return o.a.createElement("p",{className:u.a.agreeClauseToCreate},Object(i.a)(n).map(function(e,t){return 1===t?o.a.createElement("a",{className:u.a.clauseLink,href:r.b,target:"_blank",rel:"noopener noreferrer",key:t},e):3===t?o.a.createElement("a",{className:u.a.clauseLink,href:r.a,target:"_blank",rel:"noopener noreferrer",key:t},e):e}))}},594:function(e,t,n){e.exports={agreeClauseToCreate:"AgreeClauseToCreate_agreeClauseToCreate__p9RuQ",clauseLink:"AgreeClauseToCreate_clauseLink__2i6b7"}},620:function(e,t,n){e.exports={bindCreateAccount:"BindCreateAccount_bindCreateAccount__2kiQV",vercodeHelpLinkWrapper:"BindCreateAccount_vercodeHelpLinkWrapper__x5EVn",hide:"BindCreateAccount_hide__3cWgZ",bindExistBtn:"BindCreateAccount_bindExistBtn__1NuFI"}},622:function(e,t,n){},624:function(e,t,n){},628:function(e,t,n){e.exports={createAccountBasicForm:"CreateAccountBasicForm_createAccountBasicForm__28JHD",inputWrapper:"CreateAccountBasicForm_inputWrapper__3aJ-B"}},630:function(e,t,n){e.exports={bindSecurityTip:"BindSecurityTip_bindSecurityTip__bL_Qj"}},632:function(e,t,n){e.exports={bindCreate:"BindCreate_bindCreate__1RAh1",bindPhoneNumberWrapper:"BindCreate_bindPhoneNumberWrapper__1UtIq",bindSecurityTipWrapper:"BindCreate_bindSecurityTipWrapper__1OjO_"}},719:function(e,t,n){"use strict";n.r(t);var a=n(14),o=n(15),r=n(21),c=n(20),i=n(113),s=n(22),u=n(0),p=n.n(u),d=n(57),l=n(725),f=n(56),h=n(717),v=n(572),b=n(606),m=n(579),T=n(571),y=n(112),C=n(570),g=n(573),w=n(145),O=n(274),k=n(590),j=n(620),_=n.n(j),I=w.b.PHONE_NUMBER,A=w.d.ERROR,E=w.c.ACCOUNT,S=w.a.WECHAT_BIND,N=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(c.a)(t).call(this,e))).redirectToExist=function(){Object(k.a)(),n.props.history.push("/bind-existed")},n.state={requesting:!1},n.goToBind=n.goToBind.bind(Object(i.a)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){Object(k.i)()}},{key:"goToBind",value:function(){var e,t=this,n=this.props,a=n.createAccount,o=n.updateVerifyInfo,r=n.wechatSessionId;n.history;this.setState({requesting:!0}),Object(k.c)(),a().then(function(e){var t=e.account,n=e.password;return Object(f.post)(C.h,{identity:t,password:n},{needSignature:!0})}).then(function(t){var n,a=Object(h.a)(t,"data.code"),o=Object(h.a)(t,"data.content.authToken");switch(e=Object(h.a)(t,"data.content"),a){case 200:n=!!o;break;default:Object(T.a)({content:y.r}),n=!1}return n?o:Promise.reject()}).then(function(e){return Object(f.post)(C.a,{authToken:e,sessionId:r},{needSignature:!0})}).then(function(t){var n;switch(Object(h.a)(t,"data.code")){case 200:n=!0;break;case 404:n=!0,Object(T.a)({content:y.U});break;case 423:o(E,{tipLevel:A,verifyTip:y.a}),n=!1;break;case 425:n=!1,Object(T.a)({content:y.Jb});break;default:n=!1,Object(T.a)({content:y.r})}return n?e:Promise.reject()}).then(function(e){var t=e.authToken,n=e.hpts,a=e.hsHash;Object(O.a)({action:g.c,authToken:t,hpts:n,hsHash:a})}).catch(function(e){console.log(e)}).finally(function(){t.setState({requesting:!1})})}},{key:"render",value:function(){var e=this.props,t=e.countStatus,n=e.accountType,a=this.state.requesting;return p.a.createElement("div",{className:_.a.bindCreateAccount},p.a.createElement(v.a,{text:y.w,onClick:this.goToBind,loading:a}),n===I?p.a.createElement("p",{className:"".concat(_.a.vercodeHelpLinkWrapper," ").concat(t?"":_.a.hide)},p.a.createElement(b.a,{accountCreatePurpose:S,onClick:k.f})):"",p.a.createElement(m.a,null),p.a.createElement(v.a,{text:y.k,buttonWrapperClass:_.a.bindExistBtn,onClick:this.redirectToExist,loading:a}))}}]),t}(u.Component),P=Object(l.a)(Object(d.b)(function(e){return{wechatSessionId:e.wechatSessionId}},{})(N)),L=n(33),B=n(580),R=n(192),H=n(198),x=n(575),V=n.n(x),F=n(574),W=n(592),U=n(577),D=n(622),M=n.n(D),J=w.b.PHONE_NUMBER,q=w.b.EMAIL,G=w.d.DEFAULT,Q=w.d.ERROR,X=w.d.WARNING,Y=w.c.ACCOUNT,Z=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={account:"",tipLevel:G,placeHolder:"",verifyTip:""},n.onFocus=n.onFocus.bind(Object(i.a)(n)),n.onChange=n.onChange.bind(Object(i.a)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setPlaceHolderText()}},{key:"componentWillReceiveProps",value:function(e){var t=e.verifyTip,n=e.tipLevel,a=e.inputType,o=e.account,r=e.resetInput;a===Y&&this.setState({verifyTip:t,tipLevel:n}),r&&this.setState({account:o})}},{key:"onFocus",value:function(){this.setState({tipLevel:G,verifyTip:""})}},{key:"onChange",value:function(e){var t=e.target.value,n=this.props.onChange;this.setState({account:t}),n(e)}},{key:"setPlaceHolderText",value:function(){var e=this.props,t=e.accountType,n=e.placeHolder,a="";switch(t){case q:a=y.L;break;case J:a=y.O;break;default:a=""}this.setState({placeHolder:n||a})}},{key:"verifyInput",value:function(){var e,t,n=this,a=this.state.account,o=this.props,r=o.accountType,c=o.phoneNumberConflictTip,i=o.twoFactorAccountHooks,s=o.phoneNumberConflictHooks,u=o.phoneNumberInvalidHooks,p=o.phoneNumberExistedHooks,d=r===J,l="",v="";return a?d&&!U.b.test(a)?(l=y.S,v=Q,u(),t=Promise.reject(new Error(l))):(e=d?{username:a,checkUsername:""}:{email:a,checkEmail:""},t=Object(f.get)(C.e,{params:e}).then(function(e){var t=Object(h.a)(e,"data.isValidPhoneNumber"),n=Object(h.a)(e,"data.message"),o=Object(h.a)(e,"data.isTwoFactorInUse");return!1===t||n===W.h?(l=y.S,v=Q,u(),Promise.reject(new Error(l))):(o?(l=y.yb,v=X,i()):v=G,a)}).catch(function(e){var t=Object(h.a)(e,"response.status"),n=Object(h.a)(e,"response.data.type");switch(t){case 409:d&&"phoneNumberRegisteredAsUsername"===n?(c(),s()):(l=d?y.kb:y.A,d&&p());break;case 400:l=d?y.S:y.R,d&&u();break;case 412:l=d?y.kb:y.A,d&&p();break;default:l=l||y.r}return v=Q,Promise.reject(new Error(l))})):(l=y.J,v=Q,t=Promise.reject(new Error(l))),t.finally(function(){n.setState({verifyTip:l,tipLevel:v})})}},{key:"render",value:function(){var e=this.state,t=e.tipLevel,n=e.placeHolder,a=e.verifyTip,o=e.account,r=this.props,c=r.customTip,i=r.onBlur;return p.a.createElement("div",{className:M.a.accountInput},p.a.createElement(F.a,{placeHolder:n,tipLevel:t,value:o,onFocus:this.onFocus,onChange:this.onChange,useDefaultTip:!c,onBlur:i},a))}}]),t}(u.Component);Z.defaultProps={account:"",resetInput:!1,onChange:function(){},onBlur:function(){},phoneNumberConflictTip:"",twoFactorAccountHooks:function(){},phoneNumberConflictHooks:function(){},phoneNumberInvalidHooks:function(){},phoneNumberExistedHooks:function(){}};var z=Z,K=n(624),$=n.n(K),ee=w.d.DEFAULT,te=w.d.ERROR,ne=w.d.WARNING,ae=w.c.PASSWORD,oe=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={password:"",tipLevel:ee,verifyTip:""},n.onFocus=n.onFocus.bind(Object(i.a)(n)),n.onChange=n.onChange.bind(Object(i.a)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.verifyTip,n=e.tipLevel,a=e.inputType,o=e.password,r=e.resetInput;a===ae&&this.setState({verifyTip:t,tipLevel:n}),r&&this.setState({password:o})}},{key:"onFocus",value:function(){this.setState({tipLevel:ee,verifyTip:""})}},{key:"onChange",value:function(e){var t=this,n=e.target.value,a=this.props,o=a.onChange,r=a.customTip,c=a.manual;console.log(r,c),r||c?this.setState({password:n}):this.setState({password:n},function(){t.verifyInput().catch(function(e){console.log(e)})}),o(e)}},{key:"verifyInput",value:function(){var e,t=this,n=this.state.password,a="",o="";return n?n.length<6?(a=y.gb,o=te,e=Promise.reject(new Error(a))):U.a.test(n)?n.length>=6&&n.length<8?(a=y.Hb,o=ne,e=Promise.resolve(n)):(o=ee,e=Promise.resolve(n)):(a=y.hb,o=te,e=Promise.reject(new Error(a))):(a=y.J,o=te,e=Promise.reject(new Error(a))),e.finally(function(){t.setState({verifyTip:a,tipLevel:o})})}},{key:"render",value:function(){var e=this.state,t=e.tipLevel,n=e.verifyTip,a=e.password,o=this.props,r=o.customTip,c=o.placeHolder,i=o.onBlur;return p.a.createElement("div",{className:$.a.passwordInput},p.a.createElement(F.a,{placeHolder:c||y.sb,tipLevel:t,value:a,inputType:"password",onFocus:this.onFocus,onChange:this.onChange,useDefaultTip:!r,onBlur:i},n))}}]),t}(u.Component);oe.defaultProps={password:"",resetInput:!1,onChange:function(){},onBlur:function(){}};var re=oe,ce=n(607),ie=n(593),se=n(628),ue=n.n(se),pe=w.b.PHONE_NUMBER,de=w.d.DEFAULT,le=w.d.ERROR,fe=w.c.ACCOUNT,he=w.c.PASSWORD,ve=w.c.VERCODE,be=w.c.DEFAULT,me=function(e){var t=function(t){function n(e){var t;return Object(a.a)(this,n),(t=Object(r.a)(this,Object(c.a)(n).call(this,e))).state={account:"",smsSessionId:"",countStatus:!1,inputType:be,accountTipLevel:de,accountVerifyTip:"",passwordTipLevel:de,passwordVerifyTip:"",vercodeTipLevel:de,vercodeVerifyTip:""},t.verifyAccountAndPassword=t.verifyAccountAndPassword.bind(Object(i.a)(t)),t.updateSmsSessionId=t.updateSmsSessionId.bind(Object(i.a)(t)),t.updateCountState=t.updateCountState.bind(Object(i.a)(t)),t.updateVerifyInfo=t.updateVerifyInfo.bind(Object(i.a)(t)),t.createAccount=t.createAccount.bind(Object(i.a)(t)),t}return Object(s.a)(n,t),Object(o.a)(n,[{key:"componentDidMount",value:function(){if(this.props.accountType===pe){var e=V.a.get("smsSessionId");e&&this.setState({smsSessionId:e})}}},{key:"verifyAccountAndPassword",value:function(){var e=this;return Promise.all([this.refs.accountInput.verifyInput(),this.refs.passwordInput.verifyInput()]).then(function(t){var n=Object(H.a)(t,2),a=n[0],o=n[1];return e.setState({account:a}),{account:a,password:o}})}},{key:"verifyAll",value:function(){return Promise.all([this.verifyAccountAndPassword(),this.refs.vercodeInput.verifyInput()]).then(function(e){var t=Object(H.a)(e,2),n=t[0];return{account:n.account,password:n.password,vercode:t[1]}})}},{key:"updateSmsSessionId",value:function(e){this.setState({smsSessionId:e}),V.a.set("smsSessionId",e,{expires:1/24/60}),e&&V.a.remove("speechSessionId")}},{key:"updateCountState",value:function(e){this.setState({countStatus:e}),e&&this.saveAccountForSmsHelpPage()}},{key:"saveAccountForSmsHelpPage",value:function(){var e=this.state.account;V.a.set("registrationSpeechAccount",e,{expires:1/24/60})}},{key:"updateVerifyInfo",value:function(e,t){var n,a=t.tipLevel,o=t.verifyTip,r="".concat(e,"VerifyTip"),c="".concat(e,"TipLevel");this.setState((n={inputType:e},Object(R.a)(n,r,o),Object(R.a)(n,c,a),n))}},{key:"createAccount",value:function(){var e,t,n=this,a=this.state.smsSessionId,o=this.props.accountType===pe;return(o?this.verifyAll.bind(this):this.verifyAccountAndPassword.bind(this))().then(function(n){var r=n.account,c=n.password,i=n.vercode;e=r,t=c;var s={};return s=o?{otp:i,phoneNumber:r,sessionId:V.a.get("speechSessionId")||a,createPhoneNumber:"",password:c,code:"webclient"}:{email:r,createNoUsername:"",password:c,code:"webclient"},Object(f.get)(C.c,{params:s})}).then(function(a){var r=Object(h.a)(a,"data.success"),c=o?Object(h.a)(a,"data.message"):Object(h.a)(a,"data.errors[0].message"),i=Object(h.a)(a,"data.ts"),s=Object(h.a)(a,"data.tsh"),u=Object(h.a)(a,"data.errors[0].code");if(r)return{account:e,password:t,ts:i,tsh:s};if(u)switch(u){case W.f:case W.c:n.updateVerifyInfo(ve,{tipLevel:le,verifyTip:y.T});break;case W.b:n.updateVerifyInfo(he,{tipLevel:le,verifyTip:c});break;case W.a:n.updateVerifyInfo(he,{tipLevel:le,verifyTip:y.ib});break;case W.g:n.updateVerifyInfo(fe,{tipLevel:le,verifyTip:y.R})}return Promise.reject()}).finally(function(){n.setState({inputType:be})})}},{key:"render",value:function(){var t=this.props,n=t.accountType,a=t.phoneNumberConflictTip,o=t.account,r=t.password,c=t.resetInput,i=t.vercodeTimeRemain,s=t.onAccountInputChange,u=t.onPasswordInputChange,d=t.onVercodeTimeChange,l=t.phoneNumberExistedHooks,f=Object(B.a)(t,["accountType","phoneNumberConflictTip","account","password","resetInput","vercodeTimeRemain","onAccountInputChange","onPasswordInputChange","onVercodeTimeChange","phoneNumberExistedHooks"]),h=this.state,v=h.countStatus,b=h.inputType,m=h.accountVerifyTip,T=h.accountTipLevel,y=h.passwordVerifyTip,C=h.passwordTipLevel,g=h.vercodeVerifyTip,w=h.vercodeTipLevel,O=Object(L.a)({countStatus:v,accountType:n},f);return p.a.createElement("div",{className:ue.a.createAccountBasicForm},p.a.createElement("div",{className:ue.a.inputWrapper},p.a.createElement(z,{ref:"accountInput",accountType:n,phoneNumberConflictTip:a,verifyTip:m,tipLevel:T,inputType:b,account:o,resetInput:c,onChange:s,onBlur:k.l,phoneNumberExistedHooks:l})),n===pe?p.a.createElement("div",{className:ue.a.inputWrapper},p.a.createElement(ce.a,{ref:"vercodeInput",verify:this.verifyAccountAndPassword,updateSmsSessionId:this.updateSmsSessionId,updateCountState:this.updateCountState,verifyTip:g,tipLevel:w,inputType:b,vercodeTimeRemain:i,onVercodeTimeChange:d,getVercodeHooks:k.n,onBlur:k.m})):"",p.a.createElement("div",{className:ue.a.inputWrapper},p.a.createElement(re,{ref:"passwordInput",verifyTip:y,tipLevel:C,inputType:b,password:r,resetInput:c,onChange:u,onBlur:k.k})),p.a.createElement(ie.a,null),p.a.createElement(e,Object.assign({updateVerifyInfo:this.updateVerifyInfo,createAccount:this.createAccount},O)))}}]),n}(u.Component);return t.defaultProps={account:"",password:"",resetInput:!1,vercodeTimeRemain:0,phoneNumberConflictTip:"",onAccountInputChange:function(){},onPasswordInputChange:function(){},onVercodeTimeChange:function(){}},t},Te=n(630),ye=n.n(Te),Ce=function(){return p.a.createElement("p",{className:ye.a.bindSecurityTip},y.j)},ge=n(146),we=n(632),Oe=n.n(we),ke=n(114),je=w.b.EMAIL,_e=w.b.PHONE_NUMBER,Ie=me(P),Ae=me(P),Ee=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(c.a)(t).call(this,e))).phoneNumberExistedHooks=function(){var e=n.state.account,t=n.props.saveBindLoginInfo;Object(T.a)({content:y.Fb,operates:[{text:y.l},{text:ke.j,main:!0,onClick:function(){t({account:e}),n.props.history.push("/bind-existed")}}]})},n.state={accountType:_e,account:"",password:"",resetInput:!1,vercodeTimeRemainToSave:0,vercodeTimeRemainToGet:0},n.redirectHandler=n.redirectHandler.bind(Object(i.a)(n)),n.onAccountInputChange=n.onAccountInputChange.bind(Object(i.a)(n)),n.onPasswordInputChange=n.onPasswordInputChange.bind(Object(i.a)(n)),n.onVercodeTimeChange=n.onVercodeTimeChange.bind(Object(i.a)(n)),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.bindRegistrationInfo,n=t.account,a=t.password,o=t.vercodeTimeRemain,r=t.vercodeTimeStopTimeStamp,c=Date.now(),i=o-Math.ceil((c-r)/1e3);this.setState({account:n,password:a,resetInput:!0,vercodeTimeRemainToGet:i>0?i:0},function(){e.setState({resetInput:!1})})}},{key:"componentWillUnmount",value:function(){var e=this.state,t=e.account,n=e.password,a=e.vercodeTimeRemainToSave;(0,this.props.saveBindRegistrationInfo)({account:t,password:n,vercodeTimeRemain:a,vercodeTimeStopTimeStamp:Date.now()})}},{key:"onAccountInputChange",value:function(e){var t=e.target.value;this.setState({account:t})}},{key:"onPasswordInputChange",value:function(e){var t=e.target.value;this.setState({password:t})}},{key:"onVercodeTimeChange",value:function(e){this.setState({vercodeTimeRemainToSave:e})}},{key:"redirectHandler",value:function(){this.setState({accountType:je})}},{key:"render",value:function(){var e=this,t=this.state,n=t.accountType,a=t.account,o=t.password,r=t.resetInput,c=t.vercodeTimeRemainToGet;return p.a.createElement("div",{className:Oe.a.bindCreate},n===_e?p.a.createElement("div",{className:Oe.a.bindPhoneNumberWrapper},p.a.createElement("div",{className:Oe.a.bindSecurityTipWrapper},p.a.createElement(Ce,null)),p.a.createElement(Ie,{accountType:_e,phoneNumberConflictTip:function(){Object(T.a)({content:y.lb,operates:[{text:y.l},{text:y.Eb,main:!0,onClick:e.redirectHandler}]})},account:a,password:o,vercodeTimeRemain:c,onAccountInputChange:this.onAccountInputChange,onPasswordInputChange:this.onPasswordInputChange,resetInput:r,onVercodeTimeChange:this.onVercodeTimeChange,phoneNumberExistedHooks:this.phoneNumberExistedHooks})):p.a.createElement(Ae,{accountType:je}))}}]),t}(u.Component),Se={saveBindLoginInfo:function(e){return Object(ge.a)(e)},saveBindRegistrationInfo:function(e){return Object(ge.b)(e)}};t.default=Object(d.b)(function(e){return{bindRegistrationInfo:e.bindRegistrationInfo}},Se)(Ee)}}]);
//# sourceMappingURL=BindCreate.033d2d2d.chunk.js.map