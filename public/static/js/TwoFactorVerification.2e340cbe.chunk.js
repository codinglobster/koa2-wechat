(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{616:function(e,t,n){},618:function(e,t,n){e.exports={twoFactorVerification:"TwoFactorVerification_twoFactorVerification__Ona1d",mainContent:"TwoFactorVerification_mainContent__1Coma",title:"TwoFactorVerification_title__2EJ6c",sendTip:"TwoFactorVerification_sendTip__2FKud",sendTo:"TwoFactorVerification_sendTo__154Qx",inputWrapper:"TwoFactorVerification_inputWrapper__1COjM",linkWrapper:"TwoFactorVerification_linkWrapper__1Dbf0",confirmBtn:"TwoFactorVerification_confirmBtn__1nD0H"}},701:function(e,t,n){"use strict";n.r(t);var a=n(18),o=n(19),i=n(24),r=n(22),c=n(23),s=n(0),u=n.n(s),p=n(56),l=n(55),f=n(697),h=(n(141),n(549)),d=n(109),v=n(552),w=n(108),b=n(140),m=n(555),F=n(267),T=n(616),C=n.n(T),O=b.d.DEFAULT,j=b.d.ERROR,k=b.c.VERCODE,y=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).state={twoFactorCode:"",tipLevel:O,verifyTip:""},n.onFocus=n.onFocus.bind(Object(d.a)(n)),n.onChange=n.onChange.bind(Object(d.a)(n)),n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.verifyTip,n=e.tipLevel,a=e.inputType,o=e.twoFactorCode,i=e.resetInput;a===k&&this.setState({verifyTip:t,tipLevel:n}),i&&this.setState({twoFactorCode:o})}},{key:"onFocus",value:function(){this.setState({tipLevel:O,verifyTip:""})}},{key:"onChange",value:function(e){var t=e.target.value,n=this.props.onChange;this.setState({twoFactorCode:t}),n(e)}},{key:"verifyInput",value:function(){var e,t=this,n=this.state.twoFactorCode,a="",o="";return n?m.c.test(n)?(o=O,e=Promise.resolve(n)):(a=w.O,o=j,e=Promise.reject(new Error(a))):(a=w.E,o=j,e=Promise.reject(new Error(a))),e.finally(function(){t.setState({verifyTip:a,tipLevel:o})})}},{key:"render",value:function(){var e=this.state,t=e.tipLevel,n=e.verifyTip,a=e.twoFactorCode,o=this.props,i=o.customTip,r=o.placeHolder;return u.a.createElement("div",{className:C.a.twoFactorCodeInput},u.a.createElement(v.a,{placeHolder:r||w.K,tipLevel:t,value:a,onFocus:this.onFocus,onChange:this.onChange,useDefaultTip:!i},n))}}]),t}(s.Component);y.defaultProps={twoFactorCode:"",resetInput:!1,onChange:function(){}};var g=y,_=n(550),E=n(551),I=n(548),L=n(618),S=n.n(L),V=b.d.DEFAULT,W=b.d.ERROR,H=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).onInputChange=function(e){var t=e.target.value;n.setState({twoFactorCode:t})},n.onInputFocus=function(){n.setState({tipLevel:V,verifyTip:""})},n.login=function(){var e,t,a,o,i=n.state,r=i.twoFactorCode,c=i.targetUrl,s=n.props,u=s.twoFactorInfo,p=u.twoFactorToken,h=u.fromWechatLogin,d=s.wechatSessionId;r?(n.setState({requesting:!0}),e=Object(l.post)(I.b,{code:r,twoFactorToken:p},{needSignature:!0}).then(function(e){var t=Object(f.a)(e,"data.code"),n=Object(f.a)(e,"data.content.authToken");o=Object(f.a)(e,"data.content");var a=!1;switch(t){case 200:a=!!n;break;default:a=!1}return a?n:Promise.reject()}),c?e.then(function(e){e&&(window.location.href=c)}).catch(function(e){console.log(e)}):e.then(function(e){return Object(l.post)(I.a,{authToken:e,sessionId:d},{needSignature:!0})}).then(function(e){var t;switch(Object(f.a)(e,"data.code")){case 200:t=!!o;break;case 404:t=!1,Object(_.a)({content:w.P});break;case 423:Object(_.a)({content:w.a});break;case 425:h?t=!!o:(t=!1,Object(_.a)({content:w.zb}));break;default:t=!1,Object(_.a)({content:w.n})}return t?o:Promise.reject()}).then(function(e){var t=e.authToken,n=e.hpts,a=e.hsHash;Object(F.a)({action:E.c,authToken:t,hpts:n,hsHash:a})}).catch(function(e){console.log(e)}).finally(function(){n.setState({requesting:!1})})):(t=W,a=w.E,n.setState({tipLevel:t,verifyTip:a}))},n.redirectToHelper=function(){n.props.history.push("/twofactor-helper")},n.state={twoFactorCode:"",rememberMe:!1,tipLevel:V,verifyTip:"",requesting:!1},n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){document.title="\u4e24\u6b65\u9a8c\u8bc1"}},{key:"cancel",value:function(){window.history.back()}},{key:"render",value:function(){var e=this.state,t=e.requesting,n=e.tipLevel,a=e.verifyTip,o=this.props.twoFactorInfo.twoFactorHint;return u.a.createElement("div",{className:S.a.twoFactorVerification},u.a.createElement("div",{className:S.a.mainContent},u.a.createElement("h1",{className:S.a.title},w.ob),u.a.createElement("p",{className:S.a.sendTip},!o&&u.a.createElement("span",{className:S.a.sendTo},"XX XXX XXXX 3251")),u.a.createElement("div",{className:S.a.inputWrapper},u.a.createElement(g,{placeHolder:w.lb,tipLevel:n,verifyTip:a,onChange:this.onInputChange,onFocus:this.onInputFocus})),u.a.createElement(h.a,{text:w.p,loading:t,buttonWrapperClass:S.a.confirmBtn,onClick:this.login}),u.a.createElement("div",{className:S.a.linkWrapper},u.a.createElement(h.a,{text:w.Q,buttonWrapperClass:S.a.linkWrapper,onClick:this.redirectToHelper}))))}}]),t}(s.Component);t.default=Object(p.b)(function(e){return{wechatSessionId:e.wechatSessionId,twoFactorInfo:e.twoFactorInfo}},{})(H)}}]);
//# sourceMappingURL=TwoFactorVerification.2e340cbe.chunk.js.map